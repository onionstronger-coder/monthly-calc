<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Finance Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
    --primary:#14b8a6;
    --primary-dark:#0f766e;
    --bg1:#ccfbf1;
    --bg2:#e0fdfa;
    --card:rgba(255,255,255,0.9);
    --text:#0f172a;
}

body.dark{
    --bg1:#0f172a;
    --bg2:#111827;
    --card:#1f2937;
    --text:#f1f5f9;
}

*{box-sizing:border-box;}

body{
    margin:0;
    font-family:'Prompt',sans-serif;
    min-height:100vh;
    display:grid;
    place-items:center;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    transition:0.3s;
    color:var(--text);
}

.container{
    width:100%;
    max-width:460px;
    padding:36px 28px;
    border-radius:28px;
    background:var(--card);
    backdrop-filter:blur(14px);
    box-shadow:0 40px 80px rgba(0,0,0,0.15);
    animation:fadeIn 0.6s ease;
}

@keyframes fadeIn{
    from{opacity:0; transform:translateY(15px);}
    to{opacity:1; transform:translateY(0);}
}

.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
}

h2{
    margin:0;
    font-size:20px;
}

.toggle{
    cursor:pointer;
    padding:6px 10px;
    border-radius:999px;
    background:var(--primary);
    color:white;
    font-size:12px;
}

.input-group{margin-bottom:14px;}

label{
    font-size:13px;
    display:block;
    margin-bottom:4px;
}

input{
    width:100%;
    padding:11px;
    border-radius:10px;
    border:1px solid #ddd;
    font-size:14px;
}

.button-group{
    display:flex;
    gap:10px;
    margin-top:10px;
}

button{
    flex:1;
    padding:12px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    font-weight:500;
    transition:0.2s;
}

.calculate{
    background:linear-gradient(135deg,var(--primary),var(--primary-dark));
    color:white;
}

.calculate:hover{
    transform:translateY(-2px);
}

.reset{
    background:#e5e7eb;
}

.summary{
    margin:15px 0;
    font-size:14px;
    text-align:center;
}

canvas{
    margin-top:18px;
}
</style>
</head>

<body>

<div class="container">
    <div class="header">
        <h2>Finance Dashboard</h2>
        <div class="toggle" onclick="toggleDark()">Dark</div>
    </div>

    <div class="input-group"><label>รายได้</label><input type="number" id="income"></div>
    <div class="input-group"><label>ค่าเช่า</label><input type="number" id="rent"></div>
    <div class="input-group"><label>อาหาร</label><input type="number" id="food"></div>
    <div class="input-group"><label>เดินทาง</label><input type="number" id="travel"></div>
    <div class="input-group"><label>อื่น ๆ</label><input type="number" id="other"></div>

    <div class="button-group">
        <button class="calculate" onclick="calculate()">คำนวณ</button>
        <button class="reset" onclick="resetForm()">ล้างค่า</button>
    </div>

    <div class="summary" id="summary"></div>

    <canvas id="doughnutChart"></canvas>
    <canvas id="barChart"></canvas>
</div>

<script>
let doughnutChart, barChart;

window.onload = function(){
    const saved = JSON.parse(localStorage.getItem("financeData"));
    if(saved){
        for(let key in saved){
            document.getElementById(key).value = saved[key];
        }
    }
}

function calculate(){
    let income = +income.value || 0;
    let rent = +rent.value || 0;
    let food = +food.value || 0;
    let travel = +travel.value || 0;
    let other = +other.value || 0;

    if(income===0) return;

    let total = rent+food+travel+other;
    let remain = income-total;

    localStorage.setItem("financeData", JSON.stringify({income,rent,food,travel,other}));

    summary.innerHTML = 
        "รายจ่ายรวม: <b>"+total.toLocaleString()+"</b> บาท<br>"+
        "คงเหลือ: <b>"+remain.toLocaleString()+"</b> บาท";

    if(doughnutChart) doughnutChart.destroy();
    if(barChart) barChart.destroy();

    doughnutChart = new Chart(doughnutChartCanvas(),{
        type:'doughnut',
        data:{
            labels:['เช่า','อาหาร','เดินทาง','อื่น ๆ','คงเหลือ'],
            datasets:[{
                data:[rent,food,travel,other,remain>0?remain:0],
                backgroundColor:['#ef4444','#f97316','#3b82f6','#a855f7','#14b8a6']
            }]
        },
        options:{
            animation:{animateScale:true},
            plugins:{
                tooltip:{
                    callbacks:{
                        label:(c)=>{
                            let percent=((c.raw/income)*100).toFixed(1);
                            return c.label+" "+percent+"%";
                        }
                    }
                }
            }
        }
    });

    barChart = new Chart(barChartCanvas(),{
        type:'bar',
        data:{
            labels:['เช่า','อาหาร','เดินทาง','อื่น ๆ'],
            datasets:[{
                label:'ค่าใช้จ่าย',
                data:[rent,food,travel,other],
                backgroundColor:'#14b8a6'
            }]
        }
    });
}

function doughnutChartCanvas(){
    return document.getElementById('doughnutChart');
}
function barChartCanvas(){
    return document.getElementById('barChart');
}

function resetForm(){
    document.querySelectorAll("input").forEach(i=>i.value="");
    summary.innerHTML="";
    localStorage.removeItem("financeData");
    if(doughnutChart) doughnutChart.destroy();
    if(barChart) barChart.destroy();
}

function toggleDark(){
    document.body.classList.toggle("dark");
}
</script>

</body>
</html>
